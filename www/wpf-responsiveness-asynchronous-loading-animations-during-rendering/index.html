<!DOCTYPE html>
<html>
	<head>
		<title>WPF Responsiveness: Asynchronous Loading Animations During Rendering</title>
		<link rel="stylesheet" type="text/css" href="/resources/css/style.css">
	</head>

	<body>
		<div id="div_header">
			<h1>Graeme Hill's Dev Blog</h1>
		</div>

		<div id="div_content">
			<div class="div_article">
	<div class="div_article_header">
		<h1><a href="/wpf-responsiveness-asynchronous-loading-animations-during-rendering">WPF Responsiveness: Asynchronous Loading Animations During Rendering</a></h1>
		<p>2010.035</p>
	</div>
	<div class="div_article_content">
		<p>title: WPF Responsiveness: Asynchronous Loading Animations During Rendering
labels: .NET, LINQ, VB.NET, WPF</p>

<p><strong>Download the code here:</strong> <a href="http://graemehill.ca/samples/WpfLoadingOverlay.zip">WpfLoadingOverlay.zip</a></p>

<p><img class="alignright size-full wp-image-216" src="http://graemehill.ca/wp-content/uploads/2010/02/asyncloading.png" alt="" width="374" height="271" />A common issue in MDI or TDI style user interfaces is that it can take a long time to render new forms when they are opened.  Even a one or two second delay is enough to make an application seem very unresponsive.  If there's nothing you can do to improve the <em>actual</em> performance (ie: the total time to load the form) you can at least improve the <em>perceived</em> performance.  This code sample creates a simple form with a tab control and a button.  Every time you click the button it adds a new tab with 4000 text boxes.  Depending on the speed of your computer the form will probably take around five seconds to load.  As soon as you click the button, the new tab appears with a loading animation that continues until the contents have been rendered.  This is not a trivial task because we want to render a loading animation at the same time that we are waiting for another long rendering operation to complete.  Basically, we need two rendering threads.  You can't have multiple rendering threads in a single window, but you <em>can</em> put your loading animation in a new window with its own rendering thread and make it look like it's not a separate window.</p>

<p>The loading overlay is a separate, chromeless window that does not appear on the taskbar and disappears as soon as loading is complete.  The window is also semi-transparent and automatically positioned exactly over top of the form that is loading, so it looks like it is a part of the existing window.</p>

<p>Download the <a href="http://graemehill.ca/samples/WpfLoadingOverlay.zip">sample project</a> and try it out.</p>

	</div>
</div>
		</div>
	</body>
</html>